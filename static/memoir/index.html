<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simple TypeScript Project</title>
    <style>
        label {
            width: 9em;
            display:inline-block;
            margin-bottom: 1ex;
        }
    </style>
    <script>var exports = {};</script>
    <script src="memoir.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const params = new URLSearchParams(window.location.search);

            // values submitted are copied back in form elements
            ["target", "numFigures", "numDice", "flagsThatCanBeIgnored"].forEach(function (element) {
                const target = params.get(element);
                if (target) {
                    document.getElementById(element).value = target;
                }
            });

            ["flagsMeanHit", "starsMeanHit"].forEach(function (element) {
                if (params.get(element) === "on") {
                    const target = params.get(element);
                    if (target) {
                        document.getElementById(element).checked = true;
                    }
                }
            });

            if (params.get("target")) {
                let request = {
                    target: params.get("target"),
                    numFigures: Number(params.get("numFigures")),
                    numDice: Number(params.get("numDice")),
                    flagsMeanHit: !!params.get("flagsMeanHit"),
                    starsMeanHit: !!params.get("starsMeanHit"),
                };
                let response = evaluateDiceRequest(request);
                document.getElementById("output").innerText = JSON.stringify(response, null, 2);
            }
        });
    </script>
</head>
<body>
    <h1>Memoir helper</h1>
    <form action="." >
        <label for="target">Target</label>
        <select id="target" name="target">
            <option>Infantry</option>
            <option>Armor</option>
            <option>Artillery</option>
        </select>
        <br>
        <label for="numFigures">Number of figures</label>
        <input id="numFigures" name="numFigures" type="number" min="1" max="4" value="1">
        <br>
        <label for="numDice">Number of dice</label>
        <input id="numDice" name="numDice" type="number" min="1" max="5" value="3">
        <br>
        <label for="flagsMeanHit">Flags mean hit</label>
        <input id="flagsMeanHit" name="flagsMeanHit" type="checkbox">
        <label for="flagsThatCanBeIgnored" style="width: 11em">Flags that can be ignored</label>
        <input id="flagsThatCanBeIgnored" name="flagsThatCanBeIgnored" type="number" min="0" max="9" value="0">
        <br>
        <label for="starsMeanHit">Stars mean hit</label>
        <input id="starsMeanHit" name="starsMeanHit" type="checkbox">
        <br>
        <input type="submit">
    </form>


    <p id="output">Output will be shown here.</p>

</body>
</html>
