<!DOCTYPE html>
<html>


<!-- Mirrored from matteo.vaccari.name/blog/archives/293 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 24 Sep 2021 10:25:12 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="initial-scale=1">

<title>Extreme Enthusiasm  &raquo; Blog Archive   &raquo; The OCP kata</title>

<meta name="generator" content="WordPress 5.1.1" /> <!-- leave this for stats -->

<link rel="stylesheet" href="../wp-content/themes/mv2/style.css" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="Extreme Enthusiasm RSS Feed" href="../feed" />
<link rel="pingback" href="../xmlrpc.php" />

<link rel='dns-prefetch' href='http://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title="Extreme Enthusiasm &raquo; The OCP kata Comments Feed" href="293/feed" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11.2.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11.2.0\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/matteo.vaccari.name\/blog\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.1.1"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='../wp-includes/css/dist/block-library/style.min3c21.css?ver=5.1.1' type='text/css' media='all' />
<link rel='https://api.w.org/' href='../wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Project automation for Confluence plugins' href='289.html' />
<link rel='next' title='Niente Shore né Larsen' href='309.html' />
<meta name="generator" content="WordPress 5.1.1" />
<link rel="canonical" href="293.html" />
<link rel='shortlink' href='../index89a1.html?p=293' />
<link rel="alternate" type="application/json+oembed" href="../wp-json/oembed/1.0/embede7a0.json?url=http%3A%2F%2Fmatteo.vaccari.name%2Fblog%2Farchives%2F293" />
<link rel="alternate" type="text/xml+oembed" href="../wp-json/oembed/1.0/embed06f0?url=http%3A%2F%2Fmatteo.vaccari.name%2Fblog%2Farchives%2F293&amp;format=xml" />
</head>
<body>
<div id="page">

<div id="header">
	<h1><a href="../../blog">Extreme Enthusiasm</a></h1>
</div>

<div id='maincontent'>
    <div id='main-col'>

  
		<div class="navigation">
			<div class="alignleft">&laquo; <a href="289.html" rel="prev">Project automation for Confluence plugins</a></div>
			<div class="alignright"><a href="309.html" rel="next">Niente Shore né Larsen</a> &raquo;</div>
		</div>

		<div class="post" id="post-293">
			<h2><a href="293.html" rel="bookmark" title="Permanent Link: The OCP kata">The OCP kata</a></h2>

			<div class="entrytext">
				<style type="text/css" media="screen">
  p.note {
    font-size: 95%; 
    width: 80%;
    margin-left: 2em;
    font-style:italic; 
  }
</style>
<blockquote><p>
  Read the first chapter of the <a href="http://en.wikipedia.org/wiki/Design_Patterns_(book)" title="Design Patterns - Wikipedia, the free encyclopedia">Patterns book</a>, it&#8217;s all there, where it says &#8220;favor composition over inheritance&#8221;,
</p></blockquote>
<p>said <a href="http://jfranzoi.wordpress.com/">Jacopo</a>.  We were chatting about the <a href="http://en.wikipedia.org/wiki/Open/closed_principle" title="Open/closed principle - Wikipedia, the free encyclopedia">Open/Closed Principle</a>, and how I read about it in <a href="http://docs.eiffel.com/book/method/object-oriented-software-construction-2nd-edition" title="Object-oriented Software Construction, 2nd Edition | Eiffel Documentation">Meyer</a> in 1991, yet it didn&#8217;t &#8220;click&#8221; for me back then.</p>
<p>Now I see how the OCP is key to writing code that can be changed easily, which is the chief technical goal of an agile team.  I wondered, is there a way to teach and learn the OCP?  Is there a kata to learn OCP?  </p>
<p>It&#8217;s unfortunate that most <a href="http://katas.softwarecraftsmanship.org/?p=92" title="String Calculator Series &#8211; Multiple Languages     &raquo; Software Craftsmanship – Katas">common coding katas</a> result in &#8220;single-object-oriented programming&#8221;.  The famous <a href="http://butunclebob.com/ArticleS.UncleBob.TheBowlingGameKata">bowling score example</a> by Robert Martin, for instance, is usually solved by creating *one* object.  This might be fine for learning how to write simple code.  It&#8217;s not so good for learning how to do object-oriented design.  </p>
<p>So I invented this little exercise to practice and learn OCP.</p>
<p>Take any <a href="http://www.rubyquiz.com/" title="Ruby Quiz">coding problem</a>.  The <a href="http://butunclebob.com/ArticleS.UncleBob.TheBowlingGameKata">bowling score</a>, the <a href="http://katas.softwarecraftsmanship.org/?p=92" title="String Calculator Series &#8211; Multiple Languages     &raquo; Software Craftsmanship – Katas">string evaluator</a>, the <a href="http://codekata.pragprog.com/2007/01/kata_nine_back_.html" title="CodeKata: Kata Nine: Back to the CheckOut">supermarket checkout</a>, you name it.  Then follow these instructions.</p>
<p>0. Write the first failing test.  Then write a <em>factory</em> that returns an object, or an aggregate of objects, that make the test pass.  </p>
<p class="note">The factory should be limited to creating objects and linking them together.  No conditionals allowed.
</p>
<p>1. Write the next failing test.  </p>
<p>2. Can you make it pass <em>by changing the factory and/or creating a new class and nothing else</em>?  If yes, great!  Go back to 1.  If not, refactor until you can.</p>
<p class="note">The refactoring should bring the system to a state where it&#8217;s possible to implement the next test just by changing the aggregate of objects that is returned by the factory.  Be careful not to implement new functionality; the current test should still fail. </p>
<p>For instance, take the bowling score problem.  The first test is</p>
<p><code></p>
<pre name="code" class="java:nocontrols:nogutter">
  @Test public void gutterGame() throws Exception {
    BowlingGame game = new BowlingGameFactory().create();
    for (int i=0; i&lt;20; i++) {
      game.roll(0);
    }
    assertEquals(0, game.score());
  }
</pre>
<p></code></p>
<p>The code to make this pass is </p>
<p><code></p>
<pre name="code" class="java:nocontrols:nogutter">
  class BowlingGameFactory {
    public BowlingGame create() {
      return new BowlingGame();
    }
  }
  
  class BowlingGame {
    public void roll(int n) {}
    public int score() {
      return 0;
    }
  }
</pre>
<p></code></p>
<p>Nothing strange here.  Now the second test is </p>
<p><code></p>
<pre name="code" class="java:nocontrols:nogutter">
  @Test public void allOnesGame() throws Exception {
    BowlingGame game = new BowlingGameFactory().create();
    for (int i=0; i&lt;20; i++) {
      game.roll(1);
    }
    assertEquals(20, game.score());
  }
</pre>
<p></code></p>
<p>The simplest code that makes both tests pass would be to change BowlingGame to accumulate rolls in a variable.  But our rules stop us from doing that; we must find a way to implement the new functionality with a new object.  I think about it for a few minutes, and all I can think of is to delegate to another object the accumulation of rolls.  I will call this role &#8220;Rolls&#8221;.  Cool!  This forces me to invent a new design idea.  But I must be careful not to add new functionality, so I will just write a Rolls object that always returns 0.</p>
<p><code></p>
<pre name="code" class="java:nocontrols:nogutter">
  interface Rolls {
    void add(int n);
    int sum();
  }
  
  class BowlingGame {
    private final Rolls rolls;
    
    public BowlingGame(Rolls rolls) {
      this.rolls = rolls;
    }
    
    public void roll(int n) {
      rolls.add(n);
    }

    public int score() {
      return rolls.sum();
    }
  }
  
  class BowlingGameFactory {
    public BowlingGame create() {
      Rolls zero = new Rolls() {
        public void add(int n) {}
        public int sum() { return 0; }
      };
      return new BowlingGame(zero);
    }
  }
</pre>
<p></code></p>
<p>This passes the first test, and still fails the second.  In order to pass the second test, all I have to do is provide a real implementation of Rolls and change the factory.</p>
<p><code></p>
<pre name="code" class="java:nocontrols:nogutter">
  class Accumulator implements Rolls {
    void add(int n) { ... }
    int sum() { ... }
  }
    
  class BowlingGameFactory {
    public BowlingGame create() {
      return new BowlingGame(new Accumulator());
    }
  }
</pre>
<p></code></p>
<p>And so on.   The point here is to think about how to</p>
<ol>
<li>compose functionality out of existing objects, and</li>
<li>avoid reworking existing code.</li>
</ol>
<p>Feedback?</p>
<h3>Updates</h3>
<p>24/12/2013 <a href="http://www.cafe-encounter.net/" title="Chris F Carroll | Coffee | Coding | Computers | Church">Chris F Carroll</a>&#8216;s <a href="https://github.com/chrisfcarroll/OCPKatas">Gilded Mall Kata</a> is a new exercise that can be done with the OCP kata rules.  Thanks Chris!</p>
<p>29/05/2014 There is now <a href="https://github.com/xpmatteo/ocp-kata" title="The OCP Kata Github repository">a repository with a few prepared exercises</a>! I presented this at XP2014.</p>

				
				<p class="postmetadata alt">
					<small>
						This entry was posted
												on 12 January 2010 at 18:49						and is filed under <a href="category/agile.html" rel="category tag">Agile</a>, <a href="category/expressive-code.html" rel="category tag">Expressive Code</a>.
						You can follow any responses to this entry through the <a href="293/feed">RSS 2.0</a> feed.

													You can <a href="#respond">leave a response</a>, or <a href="293/trackback" rel="trackback">trackback</a> from your own site.

						
					</small>
				</p>

			</div>
		</div>

	
<!-- You can start editing here. -->

	<h3 id="comments">17 Responses to &#8220;The OCP kata&#8221;</h3> 

	<ol class="commentlist">

	
		<li class="alt" id="comment-93046">
			<cite><a href='http://www.francolombardo.net/' rel='external nofollow' class='url'>Franco Lombardo</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-93046" title="">January 15th, 2010 at 10:06</a> </small>

			<p>Matteo,</p>
<p>good exercise: we must do it at XP UG Milan! :-)</p>
<p>Now some notes. You say<br />
&#8220;1. compose functionality out of existing objects&#8221;: that&#8217;s OK.</p>
<p>&#8220;2. avoid reworking existing code&#8221;: please, could you explain this? I mean, in your example, at each step you do need to modify some part of the existing code: the BowlingGameFactory, the BowlingGame&#8230;<br />
To be honest, in the Open Close Principle what I don&#8217;t believe in is the &#8220;Close&#8221; part. Meyer, in it&#8217;s original book, thought to implement it mainly via inheritance. But, as in the beginning of your post, &#8220;favor composition over inheritance&#8221; it&#8217;s a good rule!<br />
To use composition, you must have designed some &#8220;injection&#8221; point for new behaviors: in your example, the Rolls interface could contain new behaviors, but you need to modify all your classes to accept this injection. Now your code is &#8220;closed&#8221; to change in this direction, but as soon as new change directions will arise, probably you will need to rework the existing codebase.</p>
<p>Thanks</p>
<p>Bye</p>
<p>Franco</p>

		</li>

	
	
		<li class="" id="comment-93047">
			<cite>matteo</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-93047" title="">January 18th, 2010 at 19:32</a> </small>

			<p>Hi Franco, thanks for your feedback :)</p>
<p>First let me say that this is an exercise, and it&#8217;s focused on one single aspect of OOD, namely the OCP.  I&#8217;m not saying we should work like this all the time :-)</p>
<p>Now, let me clarify the &#8220;not reworking&#8221; thing.  In an ideal world, I should be able to accept a new requirement by creating a new class, and injecting it in the system by changing the &#8220;main&#8221; or the &#8220;factory&#8221; of the system.  It would be even better if I could add new behaviour simply by configuring and instantiating existing objects.  </p>
<p>For instance, take the bowling example.  If you have all your scoring rules in a chain of responsibility, you could add the &#8220;strike&#8221; scoring rule by creating a new StrikeScoreRule class and injecting the object in the system:</p>
<p>BowlingGame create() {<br />
  Rolls rolls = new Rolls();<br />
  List<rule> rules = Arrays.asList(<br />
    new StrikeRule(rolls),<br />
    new SpareRule(rolls),<br />
    new SumOfTwoRollsRule(rolls));</p>
<p>  return new BowlingGame(rolls, rules);<br />
}</p>
<p>Suppose now that they ask you to implement &#8220;Martian Bowling&#8221;, where you have a maximum of three rolls per frame.  You might implement it by creating a SumOfThreeRolls class, and changing the factory like this:</p>
<p>BowlingGame create() {<br />
  Rolls rolls = new Rolls();<br />
  List</rule><rule> rules = Arrays.asList(<br />
    new StrikeRule(rolls),<br />
    new SpareRule(rolls),<br />
    new SumOfThreeRollsRule(rolls));</p>
<p>  return new BowlingGame(rolls, rules);<br />
}</p>
<p>or you might have a flexible object that can act as both the SumOfTwoRollsRule or the SumOfThreeRollsRule like this:</p>
<p>BowlingGame create() {<br />
  Rolls rolls = new Rolls();<br />
  List</rule><rule> rules = Arrays.asList(<br />
    new StrikeRule(rolls),<br />
    new SpareRule(rolls),<br />
    new SumOfSomeRollsRule(3, rolls));</p>
<p>  return new BowlingGame(rolls, rules);<br />
}</p>
<p>Now you ask, what if I am not living in an ideal world, and I cannot simply add new behaviour without reworking everything?  And this is the common case!  In my opinion, what you could do then is to first refactor everything *as if* you had foreseen the new requirement.  You refactor until you can apply the OCP.  Then you insert the new requirement, and it just &#8220;slides in&#8221; like magic.</p>
<p>I think it&#8217;s even better to wait until you have an actual requirement, before you make everything super-flexible.  Otherwise you run the risk of making everything too flexible, that is, to over-engineer.</rule></p>

		</li>

	
	
		<li class="alt" id="comment-93060">
			<cite><a href='http://giordano.scalzo.biz/2010/02/06/milano-xpug-january-coding-dojo/' rel='external nofollow' class='url'>Giordano Scalzo&#39;s Personal Blog &raquo; Milano XpUg January Coding Dojo</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-93060" title="">February 6th, 2010 at 16:06</a> </small>

			<p>[&#8230;] As introduction I prepared a little presentation, mainly with the aim to clarify the &#8220;Ocp Way&#8221; to do katas, as conceived by Matteo Vaccari in his blog: XpUg Coding Dojo: KataYahtzee in [&#8230;]</p>

		</li>

	
	
		<li class="" id="comment-93069">
			<cite><a href='http://www.geekagenda.it/evento/2010/02/21/84-extreme-programming-user-group-di-milano/' rel='external nofollow' class='url'>84° Extreme Programming User Group di Milano | Geek Agenda</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-93069" title="">February 21st, 2010 at 15:51</a> </small>

			<p>[&#8230;] Randori: a coppie ci si alternerà al proiettore per risolvere un semplice problema, in modalità OCP; non è obbligatorio partecipare alla coding session,ma si può semplicemente assistere allo [&#8230;]</p>

		</li>

	
	
		<li class="alt" id="comment-93072">
			<cite><a href='311.html' rel='external nofollow' class='url'>Extreme Enthusiasm &raquo; Blog Archive &raquo; Report of the first run of the OCP kata</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-93072" title="">February 23rd, 2010 at 21:49</a> </small>

			<p>[&#8230;] prepared such a good presentation mentioning, among other things, the &#8220;OCP Kata&#8221; of my earlier blog post. The &#8220;Open Closed Principle&#8221; says that we should be able to add new feature by adding [&#8230;]</p>

		</li>

	
	
		<li class="" id="comment-93089">
			<cite>Tonyx</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-93089" title="">March 2nd, 2010 at 01:24</a> </small>

			<p>Ciao Matteo,<br />
there is an implementation in c#:<br />
<a href="http://github.com/tonyx/katabowling" rel="nofollow">http://github.com/tonyx/katabowling</a></p>
<p>Ciao.</p>

		</li>

	
	
		<li class="alt" id="comment-93396">
			<cite><a href='431.html' rel='external nofollow' class='url'>Extreme Enthusiasm &raquo; Blog Archive &raquo; The Rock-Scissors-Paper OCP Dojo</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-93396" title="">July 12th, 2010 at 17:19</a> </small>

			<p>[&#8230;] kata was meant to be executed with the OCP Dojo rules. I will use Ruby today, because I want to take a break from Java. But the solution will not [&#8230;]</p>

		</li>

	
	
		<li class="" id="comment-93497">
			<cite><a href='457.html' rel='external nofollow' class='url'>Extreme Enthusiasm &raquo; Blog Archive &raquo; On discussions</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-93497" title="">October 7th, 2010 at 09:49</a> </small>

			<p>[&#8230;] I have not become convinced that iterative development, small steps, refactoring are to be avoided. I&#8217;m not advocating doing some big upfront design to make sure we can hit the release code without iterating, without incrementing functionality bit by bit, without refactoring. I still think that iterative and incremental design is the only reliable way to produce good software. But we must remember that refactoring per se is waste. Francesco Cirillo is fond of saying that emergent design is not &#8220;doing some messy work now, then I will refactor&#8221;. It&#8217;s more efficient to write incremental code that can be extended without refactoring; it&#8217;s more efficient to exploit the Open-Closed Principle! [&#8230;]</p>

		</li>

	
	
		<li class="alt" id="comment-93584">
			<cite><a href='468.html' rel='external nofollow' class='url'>Extreme Enthusiasm &raquo; Blog Archive &raquo; November is busy :-)</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-93584" title="">November 6th, 2010 at 23:34</a> </small>

			<p>[&#8230;] Days Benelux, November 25. Together with Antonio Carpentieri I will present a workshop on the Open-Closed Principle Dojo. It&#8217;s a way to learn an important principle of object-oriented [&#8230;]</p>

		</li>

	
	
		<li class="" id="comment-93601">
			<cite><a href='http://zenprogramming.wordpress.com/2010/11/10/extreme-enthusiasm-»-blog-archive-»-the-ocp-kata/' rel='external nofollow' class='url'>Extreme Enthusiasm » Blog Archive » The OCP kata &laquo; ZenAndSoftwareDevelopment</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-93601" title="">November 10th, 2010 at 13:41</a> </small>

			<p>[&#8230;] Extreme Enthusiasm » Blog Archive » The OCP kata.      Pagine [&#8230;]</p>

		</li>

	
	
		<li class="alt" id="comment-93632">
			<cite><a href='http://www.francolombardo.net/italian-agile-day-2010_post-112.html' rel='external nofollow' class='url'>Franco Lombardo &raquo; Blog Archive &raquo; Italian Agile Day 2010</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-93632" title="">November 23rd, 2010 at 17:30</a> </small>

			<p>[&#8230;] dell&#39;XP User Group di Bergamo abbiamo provato a rifare il Kata &quot;Sasso-forbici-carta&quot; seguendo le regole &quot;Aperto-chiuso&quot; suggerite da Matteo Vaccari. Il pubblico non era certo numeroso&#8230;ehm&#8230;ehm&#8230;vabbe&#39;, se vi interessa qui sono le slides e [&#8230;]</p>

		</li>

	
	
		<li class="" id="comment-93872">
			<cite><a href='http://acarpe.wordpress.com/2011/03/22/mini-xp-day-2011/' rel='external nofollow' class='url'>Mini XP Day 2011 &laquo; Legacy Code Public Enemy</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-93872" title="">March 22nd, 2011 at 11:27</a> </small>

			<p>[&#8230;] In December me and Matteo Vaccari have presented the The Open-Closed Principle Dojo based on his OCP Kata. [&#8230;]</p>

		</li>

	
	
		<li class="alt" id="comment-96725">
			<cite><a href='http://robertomereghetti.wordpress.com/2014/03/16/just-playing-with-open-closed-principle/' rel='external nofollow' class='url'>Just playing with Open Closed principle | Roberto Mereghetti</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-96725" title="">March 16th, 2014 at 19:34</a> </small>

			<p>[&#8230;] Just playing with Open Closed principle Share this:TwitterFacebookMi piace:Mi piace Caricamento&#8230; [&#8230;]</p>

		</li>

	
	
		<li class="" id="comment-96733">
			<cite><a href='http://dev.red-gate.com/code-kata-6-classic-bowling-game-scorer-open-closed/' rel='external nofollow' class='url'>Code kata 6: The classic bowling game scorer, open and closed &#124; Red Gate Software Development</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-96733" title="">April 24th, 2014 at 13:00</a> </small>

			<p>[&#8230;] the open to extension and closed to modification, we’re going to follow the workflow described at <a href="293.html" rel="nofollow">http://matteo.vaccari.name/blog/archives/293</a>. This is how it [&#8230;]</p>

		</li>

	
	
		<li class="alt" id="comment-275411">
			<cite><a href='http://martinsson-johan.blogspot.fr/' rel='external nofollow' class='url'>Johan Martinsson</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-275411" title="">June 27th, 2016 at 23:26</a> </small>

			<p>Follow to the conversation on twitter <a href="https://twitter.com/xpmatteo/status/747305326618148864" rel="nofollow">https://twitter.com/xpmatteo/status/747305326618148864</a></p>
<p>Say I have implemented the normal accumulating bowling score and I write a test for strike.<br />
It seems that making the test pass with a conditional like this is contrary to the rules. </p>
<p>        if (rolls[0] === 10) {<br />
            score = sumOf3Rolls(rolls)<br />
        } else {<br />
            score = sumOf2Rolls(rolls)<br />
        }</p>
<p>However if I refactor right after the result is (probably) the same. And to me there are several advantages to this &#8220;refactor after&#8221; approach.</p>
<p>The advantages of &#8220;refactor after&#8221; are to me<br />
&#8211; compliant to Make it work then Make it good<br />
&#8211; easier (ok that&#8217;s a bad argument for a kata)<br />
&#8211; builds a habit of looking at manifest mess before refactoring -&gt; likely to lead to simpler design</p>
<p>So my question is what will people gain from doing it in the &#8220;refactor before&#8221; way? I tried it for quite a bit, didn&#8217;t get much from it but I suspect I might be missing something here.</p>

		</li>

	
	
		<li class="" id="comment-275463">
			<cite>matteo</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-275463" title="">June 28th, 2016 at 10:45</a> </small>

			<p>The &#8220;refactor before&#8221; rule of the OCP Dojo is a trick, to force the learner to think about why a certain extension of behaviour is not possible with the current code.  This dojo is all about pushing the abstraction pedal as far as possible.  Someone said that the only way to know when something is &#8220;too much&#8221;, is to do it too much!</p>
<p>So yes, in Real Work sometimes you complicate the code a bit, and then refactor.  Some other times, when you find that implementing something is difficult, you first make it easier by refactoring (which might be difficult to do), and then you do it.</p>
<p>In a dojo context, however, if the goal is to practice creating abstractions, the rule about creating it before use is meant to force a behaviour.  If you intend to create it after, you run the risk of rushing to making the next test pass, and forget to introduce the abstraction at all.  So I think it can be OK to be flexible about introducing the abstraction after you need it, as long as you have a watchful moderator that will remind the learners to implement the abstractions!</p>
<p>Is that any clearer?  I mean, the exercise is meant to help people who aren&#8217;t used to creating abstractions.  If your audience has the opposite problem, then you might do better with another exercise, like e.g., the TDD As If You Meant It by Keith Braithwaite</p>

		</li>

	
	
		<li class="alt" id="comment-275477">
			<cite><a href='http://martinsson-johan.blogspot.fr/' rel='external nofollow' class='url'>Johan Martinsson</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-275477" title="">June 28th, 2016 at 12:07</a> </small>

			<p>Your answer is clear. I&#8217;ll try more times for my own benefit. I also project using this dojos in training teams, and I&#8217;m much more hesitant. I do see there&#8217;s probably and muscle training that is a bit different and perhaps more acute. The possible downsides to me as a training tool are</p>
<p>&#8211; Few people allow themselves to write shitty code first, and it is such an efficient design tool. This is for instance a major difficulty in learning TDD &#8211; allowing yourself to just make the test pass, and quickly<br />
&#8211; I want them to have a tool that is readily available immediately (well mostly) and the ability to refactor &#8220;after&#8221; towards OCP is easier to learn. </p>
<p>Maybe which approach is best depends on the person doing it, so &#8220;refactor before&#8221; could be an optional constraint. The base constraint being to refactor before next test.</p>

		</li>

	
	
	</ol>

 


<h3 id="respond">Leave a Reply</h3>


<form action="http://matteo.vaccari.name/blog/wp-comments-post.php" method="post" id="commentform">


<p><input type="text" name="author" id="author" value="" size="22" tabindex="1" />
<label for="author"><small>Name (required)</small></label></p>

<p><input type="text" name="email" id="email" value="" size="22" tabindex="2" />
<label for="email"><small>Mail (will not be published) (required)</small></label></p>

<p><input type="text" name="url" id="url" value="" size="22" tabindex="3" />
<label for="url"><small>Website</small></label></p>


<!--<p><small><strong>XHTML:</strong> You can use these tags: &lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;s&gt; &lt;strike&gt; &lt;strong&gt; </small></p>-->

<p><textarea name="comment" id="comment" cols="100%" rows="10" tabindex="4"></textarea></p>

<p><input name="submit" type="submit" id="submit" tabindex="5" value="Submit Comment" />
<input type="hidden" name="comment_post_ID" value="293" />
</p>
<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="7c18e440e2" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="245"/></p>
</form>



	
    </div>

    <div id='right-col'>
        <div id="sidebar">
    <ul>

      <li>
        <form method="get" id="searchform" action="http://matteo.vaccari.name/blog/">
  <div>
    <input tabindex="1" type="text" value="" name="s" id="s" />
    <input type="submit" id="searchsubmit" value="Search" />
  </div>
</form>
      </li>

      <li>

        <h2>About</h2>

	I am a software developer working with <a href="http://thoughtworks.com/">Thoughtworks Italia</a>.
        I'm a fan of <a
        href="http://extremeprogramming.org/">Extreme Programming</a>.
        I&nbsp;helped organize the <a
        href="http://essap.dicom.uninsubria.it/">European Summer School on
        Agile Programming</a>

      </li>

      <li>
            </li>

      <li class="pagenav"><h2>Pages</h2><ul><li class="page_item page-item-851"><a href="../selected-tdd-resources-to-start.html">Selected TDD Resources To Start</a></li>
<li class="page_item page-item-583"><a href="../tdd-resources.html">TDD Resources</a></li>
<li class="page_item page-item-247"><a href="../the-hexagonal-architecture.html">The Hexagonal Architecture</a></li>
</ul></li>

      
      <li><h2>Archives</h2>
        <ul>
        	<li><a href='date/2018/10.html'>October 2018</a></li>
	<li><a href='date/2017/09.html'>September 2017</a></li>
	<li><a href='date/2016/08.html'>August 2016</a></li>
	<li><a href='date/2016/03.html'>March 2016</a></li>
	<li><a href='date/2016/01.html'>January 2016</a></li>
	<li><a href='date/2014/12.html'>December 2014</a></li>
	<li><a href='date/2014/10.html'>October 2014</a></li>
	<li><a href='date/2014/06.html'>June 2014</a></li>
	<li><a href='date/2014/02.html'>February 2014</a></li>
	<li><a href='date/2013/12.html'>December 2013</a></li>
	<li><a href='date/2013/11.html'>November 2013</a></li>
	<li><a href='date/2013/06.html'>June 2013</a></li>
	<li><a href='date/2013/05.html'>May 2013</a></li>
	<li><a href='date/2013/03.html'>March 2013</a></li>
	<li><a href='date/2013/02.html'>February 2013</a></li>
	<li><a href='date/2012/10.html'>October 2012</a></li>
	<li><a href='date/2012/08.html'>August 2012</a></li>
	<li><a href='date/2012/07.html'>July 2012</a></li>
	<li><a href='date/2012/06.html'>June 2012</a></li>
	<li><a href='date/2012/05.html'>May 2012</a></li>
	<li><a href='date/2012/04.html'>April 2012</a></li>
	<li><a href='date/2012/01.html'>January 2012</a></li>
	<li><a href='date/2011/12.html'>December 2011</a></li>
	<li><a href='date/2011/11.html'>November 2011</a></li>
	<li><a href='date/2011/10.html'>October 2011</a></li>
	<li><a href='date/2011/07.html'>July 2011</a></li>
	<li><a href='date/2011/06.html'>June 2011</a></li>
	<li><a href='date/2011/05.html'>May 2011</a></li>
	<li><a href='date/2011/04.html'>April 2011</a></li>
	<li><a href='date/2011/03.html'>March 2011</a></li>
	<li><a href='date/2011/02.html'>February 2011</a></li>
	<li><a href='date/2010/11.html'>November 2010</a></li>
	<li><a href='date/2010/10.html'>October 2010</a></li>
	<li><a href='date/2010/09.html'>September 2010</a></li>
	<li><a href='date/2010/08.html'>August 2010</a></li>
	<li><a href='date/2010/07.html'>July 2010</a></li>
	<li><a href='date/2010/06.html'>June 2010</a></li>
	<li><a href='date/2010/05.html'>May 2010</a></li>
	<li><a href='date/2010/04.html'>April 2010</a></li>
	<li><a href='date/2010/03.html'>March 2010</a></li>
	<li><a href='date/2010/02.html'>February 2010</a></li>
	<li><a href='date/2010/01.html'>January 2010</a></li>
	<li><a href='date/2009/12.html'>December 2009</a></li>
	<li><a href='date/2009/11.html'>November 2009</a></li>
	<li><a href='date/2009/10.html'>October 2009</a></li>
	<li><a href='date/2009/09.html'>September 2009</a></li>
	<li><a href='date/2009/07.html'>July 2009</a></li>
	<li><a href='date/2009/05.html'>May 2009</a></li>
	<li><a href='date/2009/04.html'>April 2009</a></li>
	<li><a href='date/2009/03.html'>March 2009</a></li>
	<li><a href='date/2009/02.html'>February 2009</a></li>
	<li><a href='date/2009/01.html'>January 2009</a></li>
	<li><a href='date/2008/12.html'>December 2008</a></li>
	<li><a href='date/2008/11.html'>November 2008</a></li>
	<li><a href='date/2008/10.html'>October 2008</a></li>
	<li><a href='date/2008/09.html'>September 2008</a></li>
	<li><a href='date/2008/07.html'>July 2008</a></li>
	<li><a href='date/2008/06.html'>June 2008</a></li>
	<li><a href='date/2008/05.html'>May 2008</a></li>
	<li><a href='date/2008/04.html'>April 2008</a></li>
	<li><a href='date/2008/01.html'>January 2008</a></li>
	<li><a href='date/2007/11.html'>November 2007</a></li>
	<li><a href='date/2007/10.html'>October 2007</a></li>
	<li><a href='date/2007/09.html'>September 2007</a></li>
	<li><a href='date/2007/06.html'>June 2007</a></li>
	<li><a href='date/2007/05.html'>May 2007</a></li>
	<li><a href='date/2007/04.html'>April 2007</a></li>
	<li><a href='date/2007/03.html'>March 2007</a></li>
	<li><a href='date/2007/02.html'>February 2007</a></li>
	<li><a href='date/2007/01.html'>January 2007</a></li>
	<li><a href='date/2006/12.html'>December 2006</a></li>
	<li><a href='date/2006/11.html'>November 2006</a></li>
	<li><a href='date/2006/10.html'>October 2006</a></li>
	<li><a href='date/2006/09.html'>September 2006</a></li>
	<li><a href='date/2006/08.html'>August 2006</a></li>
	<li><a href='date/2006/07.html'>July 2006</a></li>
	<li><a href='date/2006/06.html'>June 2006</a></li>
	<li><a href='date/2006/05.html'>May 2006</a></li>
	<li><a href='date/2006/04.html'>April 2006</a></li>
	<li><a href='date/2006/03.html'>March 2006</a></li>
	<li><a href='date/2006/02.html'>February 2006</a></li>
	<li><a href='date/2006/01.html'>January 2006</a></li>
        </ul>
      </li>

      <li><h2>Categories</h2>
        <ul>
        	<li class="cat-item cat-item-1"><a href="category/agile.html" >Agile</a> (229)
</li>
	<li class="cat-item cat-item-3"><a href="category/books.html" >Books</a> (2)
</li>
	<li class="cat-item cat-item-11"><a href="category/design-exercise.html" >Design Exercise</a> (5)
</li>
	<li class="cat-item cat-item-6"><a href="category/essay.html" >Essay</a> (13)
</li>
	<li class="cat-item cat-item-8"><a href="category/expressive-code.html" >Expressive Code</a> (11)
</li>
	<li class="cat-item cat-item-10"><a href="category/fundamentals.html" >Fundamentals</a> (6)
</li>
	<li class="cat-item cat-item-9"><a href="category/other.html" >other</a> (1)
</li>
        </ul>
      </li>

      
    </ul>
  </div>

    </div>
</div>


<hr />
<div id="footer">
<address>
  <script type="text/javascript">eval(unescape('%64%6f%63%75%6d%65%6e%74%2e%77%72%69%74%65%28%27%3c%61%20%68%72%65%66%3d%22%6d%61%69%6c%74%6f%3a%76%61%63%63%61%72%69%40%70%6f%62%6f%78%2e%63%6f%6d%22%3e%76%61%63%63%61%72%69%40%70%6f%62%6f%78%2e%63%6f%6d%3c%2f%61%3e%27%29%3b'))</script>
</address>
</div>
</div>
  <script type='text/javascript' src='../wp-includes/js/wp-embed.min3c21.js?ver=5.1.1'></script>
<script async="async" type='text/javascript' src='../wp-content/plugins/akismet/_inc/form0235.js?ver=4.1.1'></script>
</body>

<!-- Mirrored from matteo.vaccari.name/blog/archives/293 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 24 Sep 2021 10:25:12 GMT -->
</html>
