<!DOCTYPE html>
<html>


<!-- Mirrored from matteo.vaccari.name/blog/archives/date/2006/08 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 24 Sep 2021 10:21:25 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="initial-scale=1">

<title>Extreme Enthusiasm   &raquo; 2006 &raquo; August</title>

<meta name="generator" content="WordPress 5.1.1" /> <!-- leave this for stats -->

<link rel="stylesheet" href="../../../wp-content/themes/mv2/style.css" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="Extreme Enthusiasm RSS Feed" href="../../../feed" />
<link rel="pingback" href="../../../xmlrpc.php" />

<link rel='dns-prefetch' href='http://s.w.org/' />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11.2.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11.2.0\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/matteo.vaccari.name\/blog\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.1.1"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='../../../wp-includes/css/dist/block-library/style.min3c21.css?ver=5.1.1' type='text/css' media='all' />
<link rel='https://api.w.org/' href='../../../wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.1.1" />
</head>
<body>
<div id="page">

<div id="header">
	<h1><a href="../../../../blog">Extreme Enthusiasm</a></h1>
</div>

<div id='maincontent'>
  <div id='main-col'>

		
				<h2 class="pagetitle">Archive for August, 2006</h2>

		
		<div class="navigation">
			<div class="alignleft"></div>
			<div class="alignright"></div>
		</div>

				<div class="post">
				<h3 id="post-42"><a href="../../42.html" rel="bookmark" title="Permanent Link to Uploading files to Rails models">Uploading files to Rails models</a></h3>
				<small>Tuesday, August 29th, 2006</small>

				<div class="entry">
					<p><em>Riassunto: ecco come aggiungere un&#8217;immagine a un modello in una applicazione Rails<br />
</em></p>
<p>Just a summary of what it takes to add an image to a model in a Rails application.  This is to remind myself of the steps it took to make it work.</p>
<p>There are two plugins out there: <a href="http://www.kanthak.net/opensource/file_column/">file_column</a> and acts_as_attachment.  The second is more full-featured, and requires a separate table for each attachment.  So I chose to use the former, for simplicity.  I can always change my mind later.</p>
<p>Using file_column is straightforward, unless you wish to change the default place where image files are saved; in which case you must add options that are not well documented.  The default location is not good, because it chooses a different directory for every model: public/people, public/places, public/foobar, and so on.  This is not good when deploying with capistrano, because you will need to make all of these dirs symbolic links.  Much better to have a single root for all uploads: public/uploads/people, public/uploads/places, &#8230;</p>
<p>Suppose you want to add an &#8220;image&#8221; file attachment to a model &#8220;Foobar&#8221;.  First you must add an &#8220;image&#8221; column to the foobars table:</p>
<pre><code>
  $ script/generate migration AddImageColumnToFoobars
  ...
</code></pre>
<p>edit the migration file</p>
<pre><code>
class AddColumnImageToFoobars &lt; ActiveRecord::Migration
  def self.up
    add_column :foobars, :image, :string
  end

  def self.down
    remove_column :foobars, :image
  end
end
</code></pre>
<p>and execute the migration</p>
<pre><code>
  $ rake migrate
  ...
</code></pre>
<p>Time to do a little functional test.  Open up test/functional/foobar_controller_test.rb and write something like</p>
<pre><code>
  def test_update_image
    post :edit, :id => 2, :foobar => {
      :image => upload(Test::Unit::TestCase.fixture_path 
          + '/files/animal.jpg', 'image/jpg'),
    }
    assert_redirected_to :action => 'page', :name => old_content.name
    updated_foobar = Content.find(2)
    assert_not_nil updated_foobar.image, "what? no image?"
    assert_equal '2/animal.jpg', updated_foobar.image_relative_path
  end
</code></pre>
<p>Run the test.  Does it fail?  Good!  Failure is progress.</p>
<p>Now modify the Foobar model</p>
<pre><code>
class Foobar &lt; ActiveRecord::Base                                                       
  file_column :image, 
    :root_path =&gt; File.join(RAILS_ROOT, "public", "upload"), 
    :web_root =&gt; "upload/"
end
</code></pre>
<p>The :root_path option says we want to save all uploads beneath the &#8220;public/uploads&#8221; directory.  The :web_root is needed so that the proper url for the pictures can be computed.  A bit redundant, but I see how this can be handy for apps that are deployed on multiple servers.</p>
<p>Try the functional test again.  It should work now.</p>
<p>Now modify the views/foobar/_form.html adding</p>
<pre><code>
&lt;%= file_column_field "foobar", "image" %&gt;
</code></pre>
<p>You must also modify the form tag in views/foobar/edit.rhtml and new.rhtml adding multipart encoding, this way:</p>
<pre><code>
&lt;%= form_tag({:action =&gt; 'update', :id =&gt; @foobar}, 
        {:multipart =&gt; true}) %&gt;
</code></pre>
<p>otherwise, upload will not work.</p>
<p>At last, you can show the image in your Foobar pages:</p>
<pre><code>
&lt;%= image_tag url_for_file_column(@foobar, "image") if @foobar.image %&gt;
</code></pre>
<p>The &#8220;if&#8221; part is needed in case no image has been uploaded yet.</p>
<p>The finishing touch is to add validations to the model:</p>
<pre><code>
class Foobar &lt; ActiveRecord::Base                                                       
  file_column :image, 
    :root_path =&gt; File.join(RAILS_ROOT, "public", "upload"), 
    :web_root =&gt; "upload/"

  validates_file_format_of :image, :in => ["gif", "png", "jpg"]
  validates_filesize_of :image, :in => 15.kilobytes..1.megabyte
  validates_image_size :image, :min => "1200x1800"
end
</code></pre>
<h3>Conclusion</h3>
<p>The &#8220;file_column&#8221; plugin is simple and it works beautifully, even if the docs could be better.  Be sure to consult the rdoc within the source files.</p>
<p>If you need to run searches on your uploaded files, such as, for instance, looking for all pictures in &#8220;landscape&#8221; format, then file_column does not help.  The other solution, acts_as_attachment could be the right choice.</p>
				</div>

				<p class="postmetadata">Posted in <a href="../../category/agile.html" rel="category tag">Agile</a> |   <a href="../../42.html#comments">5 Comments &#187;</a></p>
		</div>

				<div class="post">
				<h3 id="post-41"><a href="../../41.html" rel="bookmark" title="Permanent Link to The Good Life">The Good Life</a></h3>
				<small>Thursday, August 24th, 2006</small>

				<div class="entry">
					<p>Summary: <em>The Good Life</em> by Jay McInerney is not one of his &#8220;great&#8221; novels.</p>
<p>Ho appena finito di leggere <em>The Good Life</em> di Jay McInerney.  E&#8217; la storia di <strong>Luke</strong>, un esperto finanziario di Wall Street di grande successo, sposato a <strong>Sasha</strong>, una donna estremamente bella e sofisticata; e di <strong>Corrine</strong>, una autrice di sceneggiature di scarso successo, mamma di due gemelli e sposata a <strong>Russel</strong>, un editore di modesto successo.  </p>
<h3>Riassunto</h3>
<p>Quello che segue è un riassunto senza troppi spoiler.</p>
<p>Luke è in crisi di mezza età, e si è preso un &#8220;sabbatico&#8221; dal suo lavoro per riprendere i contatti con sua moglie e sua figlia Ashley, che a 13 anni è in piena adolescenza e non ne vuole sapere.</p>
<p>Russel è in crisi di mezza età; ha un&#8217;amante che soddisfa i suoi desideri sessuali e per il resto quando è a casa si dedica in parte ai gemelli, ma soprattutto al suo grande hobby, la cucina (immaginatevi che palle.)</p>
<p>Corrine è in crisi perché Russel è distante (a letto legge i manoscritti); perché non riesce a completare la sceneggiatura a cui sta lavorando; perché i gemelli sono nati con la fecondazione artificiale; perché è convinta di essere una cattiva madre&#8230;</p>
<p>La vicenda si svolge a New York dal 10 settembre 2001 fino al Natale dello stesso anno.  Il giorno dell&#8217;attacco aereo Luke si salva per caso.  Incontra Corrine; cominciano a frequentarsi.</p>
<h3>IMHO</h3>
<p>Prima di tutto mettiamo in chiaro che si tratta di un libro di un autore di prima classe.  I personaggi escono fuori dalla pagina, si capisce che l&#8217;autore descrive sempre solo persone che conosce e situazioni che ha vissuto.  Questo per me è importantissimo: scrivere significa <em>avere delle storie da raccontare</em>.</p>
<p>Dieci anni fa, quando lessi <em>The Last of the Savage</em>, continuavo a pensare a quel libro anche dopo mesi che lo avevo finito.  E&#8217; probabilmente uno dei 10 romanzi più belli che ho letto (non che questo significhi gran che) e sicuramente il più bello di McInerney.</p>
<p>Venti anni fa, quando lessi <em>Le mille luci di New York</em> (Bright Lights, Big City) mi fece lo stesso effetto.  Un romanzo perfetto, un colpo di fulmine.  Lo regalai a tutti i miei amici.</p>
<p>Purtroppo questa cadenza di un grande romanzo ogni dieci anni non ha funzionato; almeno per me, il colpo di fulmine con questo romanzo non c&#8217;è stato.  Sarà perché non riuscivo a identificarmi, a &#8220;tifare&#8221; per nessuno dei personaggi?  Ma neanche in <em>The Last of The Savage</em> potevo.  Però in quella storia c&#8217;era un respiro epico che in questo libro non c&#8217;è.  </p>
<p><em>The Good Life</em> ha dei buoni momenti, e dei momenti tediosi.  Fra i momenti migliori c&#8217;è il contrasto fra la New York sofisticata e il Sud rurale degli Stati Uniti (che era un&#8217;elemento chiave di <em>Last of the Savage</em>)  Fra i momenti più noiosi, le conversazioni degli amici sofisticati di Russel e Corrine (fatta eccezione per Washington, che è fichissimo) e gli eventi mondani di Sasha e Luke.</p>
<p>Un osservazione carina la fa Jim Crespi, amico di Russel e regista di Hollywood negli anni &#8217;70: in quegli anni i produttori di Hollywood si resero conto che non erano più capaci di fare i film, e si affidarono a dei giovani (Scorsese, Altman, Coppola, Cimino&#8230;) che ribaltarono il cinema.  Poi un anno vado a vedere &#8220;Pulp Fiction&#8221;, e mi ritrovo a vedere un film dove tutto è fatto per finta, esagerato e ironico.  Mentre il cinema dei &#8217;70 era tutto sull&#8217;onestà e la verità, quello che va adesso è un cinema di strizzate d&#8217;occhio e di scherzi.  (Non ho sottomano il libro, se no metterei la citazione esatta.)  Nel romanzo Jim scompare sotto le torri.</p>
<h3>In conclusione&#8230;</h3>
<p>Se non hai mai letto McInerney, comincia dai due che ho elogiato qui sopra.  Non te ne pentirai.  (Statisticamente, questo autore piace molto di più ai maschi.  Non so perché.)  Se conosci McInerney, questo è un buon libro: ma non è uno dei suoi libri &#8220;A&#8221;.  Mettiamolo insieme ai suoi libri &#8220;B&#8221;, come <em>Riscatto</em> (Ransom) o <em>Tanto per cambiare</em> (The Story of My Life).</p>
				</div>

				<p class="postmetadata">Posted in <a href="../../category/agile.html" rel="category tag">Agile</a> |   <a href="../../41.html#respond">No Comments &#187;</a></p>
		</div>

		
		<div class="navigation">
			<div class="alignleft"></div>
			<div class="alignright"></div>
		</div>

	  	</div>

  <div id='right-col'>
        <div id="sidebar">
    <ul>

      <li>
        <form method="get" id="searchform" action="http://matteo.vaccari.name/blog/">
  <div>
    <input tabindex="1" type="text" value="" name="s" id="s" />
    <input type="submit" id="searchsubmit" value="Search" />
  </div>
</form>
      </li>

      <li>

        <h2>About</h2>

	I am a software developer working with <a href="http://thoughtworks.com/">Thoughtworks Italia</a>.
        I'm a fan of <a
        href="http://extremeprogramming.org/">Extreme Programming</a>.
        I&nbsp;helped organize the <a
        href="http://essap.dicom.uninsubria.it/">European Summer School on
        Agile Programming</a>

      </li>

      <li>
            <p>You are currently browsing the <a href="../../../index.html">Extreme Enthusiasm</a> weblog archives
      for August, 2006.</p>

            </li>

      <li class="pagenav"><h2>Pages</h2><ul><li class="page_item page-item-851"><a href="../../../selected-tdd-resources-to-start.html">Selected TDD Resources To Start</a></li>
<li class="page_item page-item-583"><a href="../../../tdd-resources.html">TDD Resources</a></li>
<li class="page_item page-item-247"><a href="../../../the-hexagonal-architecture.html">The Hexagonal Architecture</a></li>
</ul></li>

      
      <li><h2>Archives</h2>
        <ul>
        	<li><a href='../2018/10.html'>October 2018</a></li>
	<li><a href='../2017/09.html'>September 2017</a></li>
	<li><a href='../2016/08.html'>August 2016</a></li>
	<li><a href='../2016/03.html'>March 2016</a></li>
	<li><a href='../2016/01.html'>January 2016</a></li>
	<li><a href='../2014/12.html'>December 2014</a></li>
	<li><a href='../2014/10.html'>October 2014</a></li>
	<li><a href='../2014/06.html'>June 2014</a></li>
	<li><a href='../2014/02.html'>February 2014</a></li>
	<li><a href='../2013/12.html'>December 2013</a></li>
	<li><a href='../2013/11.html'>November 2013</a></li>
	<li><a href='../2013/06.html'>June 2013</a></li>
	<li><a href='../2013/05.html'>May 2013</a></li>
	<li><a href='../2013/03.html'>March 2013</a></li>
	<li><a href='../2013/02.html'>February 2013</a></li>
	<li><a href='../2012/10.html'>October 2012</a></li>
	<li><a href='../2012/08.html'>August 2012</a></li>
	<li><a href='../2012/07.html'>July 2012</a></li>
	<li><a href='../2012/06.html'>June 2012</a></li>
	<li><a href='../2012/05.html'>May 2012</a></li>
	<li><a href='../2012/04.html'>April 2012</a></li>
	<li><a href='../2012/01.html'>January 2012</a></li>
	<li><a href='../2011/12.html'>December 2011</a></li>
	<li><a href='../2011/11.html'>November 2011</a></li>
	<li><a href='../2011/10.html'>October 2011</a></li>
	<li><a href='../2011/07.html'>July 2011</a></li>
	<li><a href='../2011/06.html'>June 2011</a></li>
	<li><a href='../2011/05.html'>May 2011</a></li>
	<li><a href='../2011/04.html'>April 2011</a></li>
	<li><a href='../2011/03.html'>March 2011</a></li>
	<li><a href='../2011/02.html'>February 2011</a></li>
	<li><a href='../2010/11.html'>November 2010</a></li>
	<li><a href='../2010/10.html'>October 2010</a></li>
	<li><a href='../2010/09.html'>September 2010</a></li>
	<li><a href='../2010/08.html'>August 2010</a></li>
	<li><a href='../2010/07.html'>July 2010</a></li>
	<li><a href='../2010/06.html'>June 2010</a></li>
	<li><a href='../2010/05.html'>May 2010</a></li>
	<li><a href='../2010/04.html'>April 2010</a></li>
	<li><a href='../2010/03.html'>March 2010</a></li>
	<li><a href='../2010/02.html'>February 2010</a></li>
	<li><a href='../2010/01.html'>January 2010</a></li>
	<li><a href='../2009/12.html'>December 2009</a></li>
	<li><a href='../2009/11.html'>November 2009</a></li>
	<li><a href='../2009/10.html'>October 2009</a></li>
	<li><a href='../2009/09.html'>September 2009</a></li>
	<li><a href='../2009/07.html'>July 2009</a></li>
	<li><a href='../2009/05.html'>May 2009</a></li>
	<li><a href='../2009/04.html'>April 2009</a></li>
	<li><a href='../2009/03.html'>March 2009</a></li>
	<li><a href='../2009/02.html'>February 2009</a></li>
	<li><a href='../2009/01.html'>January 2009</a></li>
	<li><a href='../2008/12.html'>December 2008</a></li>
	<li><a href='../2008/11.html'>November 2008</a></li>
	<li><a href='../2008/10.html'>October 2008</a></li>
	<li><a href='../2008/09.html'>September 2008</a></li>
	<li><a href='../2008/07.html'>July 2008</a></li>
	<li><a href='../2008/06.html'>June 2008</a></li>
	<li><a href='../2008/05.html'>May 2008</a></li>
	<li><a href='../2008/04.html'>April 2008</a></li>
	<li><a href='../2008/01.html'>January 2008</a></li>
	<li><a href='../2007/11.html'>November 2007</a></li>
	<li><a href='../2007/10.html'>October 2007</a></li>
	<li><a href='../2007/09.html'>September 2007</a></li>
	<li><a href='../2007/06.html'>June 2007</a></li>
	<li><a href='../2007/05.html'>May 2007</a></li>
	<li><a href='../2007/04.html'>April 2007</a></li>
	<li><a href='../2007/03.html'>March 2007</a></li>
	<li><a href='../2007/02.html'>February 2007</a></li>
	<li><a href='../2007/01.html'>January 2007</a></li>
	<li><a href='12.html'>December 2006</a></li>
	<li><a href='11.html'>November 2006</a></li>
	<li><a href='10.html'>October 2006</a></li>
	<li><a href='09.html'>September 2006</a></li>
	<li><a href='08.html'>August 2006</a></li>
	<li><a href='07.html'>July 2006</a></li>
	<li><a href='06.html'>June 2006</a></li>
	<li><a href='05.html'>May 2006</a></li>
	<li><a href='04.html'>April 2006</a></li>
	<li><a href='03.html'>March 2006</a></li>
	<li><a href='02.html'>February 2006</a></li>
	<li><a href='01.html'>January 2006</a></li>
        </ul>
      </li>

      <li><h2>Categories</h2>
        <ul>
        	<li class="cat-item cat-item-1"><a href="../../category/agile.html" >Agile</a> (229)
</li>
	<li class="cat-item cat-item-3"><a href="../../category/books.html" >Books</a> (2)
</li>
	<li class="cat-item cat-item-11"><a href="../../category/design-exercise.html" >Design Exercise</a> (5)
</li>
	<li class="cat-item cat-item-6"><a href="../../category/essay.html" >Essay</a> (13)
</li>
	<li class="cat-item cat-item-8"><a href="../../category/expressive-code.html" >Expressive Code</a> (11)
</li>
	<li class="cat-item cat-item-10"><a href="../../category/fundamentals.html" >Fundamentals</a> (6)
</li>
	<li class="cat-item cat-item-9"><a href="../../category/other.html" >other</a> (1)
</li>
        </ul>
      </li>

      
    </ul>
  </div>

    </div>
  </div>
</div>


<hr />
<div id="footer">
<address>
  <script type="text/javascript">eval(unescape('%64%6f%63%75%6d%65%6e%74%2e%77%72%69%74%65%28%27%3c%61%20%68%72%65%66%3d%22%6d%61%69%6c%74%6f%3a%76%61%63%63%61%72%69%40%70%6f%62%6f%78%2e%63%6f%6d%22%3e%76%61%63%63%61%72%69%40%70%6f%62%6f%78%2e%63%6f%6d%3c%2f%61%3e%27%29%3b'))</script>
</address>
</div>
</div>
  <script type='text/javascript' src='../../../wp-includes/js/wp-embed.min3c21.js?ver=5.1.1'></script>
</body>

<!-- Mirrored from matteo.vaccari.name/blog/archives/date/2006/08 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 24 Sep 2021 10:21:25 GMT -->
</html>
