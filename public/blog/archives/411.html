<!DOCTYPE html>
<html>


<!-- Mirrored from matteo.vaccari.name/blog/archives/411 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 24 Sep 2021 10:26:42 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="initial-scale=1">

<title>Extreme Enthusiasm  &raquo; Blog Archive   &raquo; Answering Jacopo&#8217;s comment</title>

<meta name="generator" content="WordPress 5.1.1" /> <!-- leave this for stats -->

<link rel="stylesheet" href="../wp-content/themes/mv2/style.css" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="Extreme Enthusiasm RSS Feed" href="../feed" />
<link rel="pingback" href="../xmlrpc.php" />

<link rel='dns-prefetch' href='http://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title="Extreme Enthusiasm &raquo; Answering Jacopo&#8217;s comment Comments Feed" href="411/feed" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11.2.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11.2.0\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/matteo.vaccari.name\/blog\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.1.1"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='../wp-includes/css/dist/block-library/style.min3c21.css?ver=5.1.1' type='text/css' media='all' />
<link rel='https://api.w.org/' href='../wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Test behaviour not syntax' href='407.html' />
<link rel='next' title='TDD is no substitute for knowing what you are doing' href='416.html' />
<meta name="generator" content="WordPress 5.1.1" />
<link rel="canonical" href="411.html" />
<link rel='shortlink' href='../index8eaf.html?p=411' />
<link rel="alternate" type="application/json+oembed" href="../wp-json/oembed/1.0/embedeecc.json?url=http%3A%2F%2Fmatteo.vaccari.name%2Fblog%2Farchives%2F411" />
<link rel="alternate" type="text/xml+oembed" href="../wp-json/oembed/1.0/embed1e63?url=http%3A%2F%2Fmatteo.vaccari.name%2Fblog%2Farchives%2F411&amp;format=xml" />
</head>
<body>
<div id="page">

<div id="header">
	<h1><a href="../../blog">Extreme Enthusiasm</a></h1>
</div>

<div id='maincontent'>
    <div id='main-col'>

  
		<div class="navigation">
			<div class="alignleft">&laquo; <a href="407.html" rel="prev">Test behaviour not syntax</a></div>
			<div class="alignright"><a href="416.html" rel="next">TDD is no substitute for knowing what you are doing</a> &raquo;</div>
		</div>

		<div class="post" id="post-411">
			<h2><a href="411.html" rel="bookmark" title="Permanent Link: Answering Jacopo&#8217;s comment">Answering Jacopo&#8217;s comment</a></h2>

			<div class="entrytext">
				<p>In a comment to my post about <a href="407.html">testing data serialization</a>, <a href="http://jfranzoi.wordpress.com/" title="Software Engineering Slave">Jacopo</a> says:</p>
<blockquote><p>
well, if you’re lucky enough, both client and webservice will be under your control, so yes: focus on data (structure) sent/received, to be sure they’re as expected.</p>
<p>but is far more common a scenario where webservice aren’t under your control, they represent and integration point with external systems: that is, XML document syntax _is_ what you’re trying to test. for example, (I can think of at least 2 cases that happened to me in the last 6 months) switching from one parsing library to another or simply testing interoperabily (such as Java/.NET).</p>
<p>of course, not as much domain logic there ;) but still, webservices aren’t supposed to encapsulate domain knowledge, so focusing on syntax would be good enough.
</p></blockquote>
<p>Hi Jacopo,</p>
<p>Even in your case, the users of your service will be interested in doing something with your data, not in its syntax.</p>
<p>Consider this modified test: there&#8217;s an error in it, but it&#8217;s not easy to see.</p>
<p><code></p>
<pre>
@Test public static void serializesToCorrectXml() {
  DataStructure structure = new ....;
  XmlSerializer s = new XmlSerializer();
  String xml = s.serialize(structure);
  assertEquals("&lt;?xml version=\&quot;1.0\&quot;&gt;&lt;foo&gt;&lt;bar&gt;zot&lt;/bar&gt;&lt;/foo&gt;&quot;,
    xml);
}</pre>
<p></code><br />
Can you see it?  The xml prolog is broken.  Now if your code passes this test, it will break in production with your paying customers.</p>
<p>Consider this other test:</p>
<p><code></p>
<pre>
@Test public static void serializesArray() {
  XmlSerializer s = new XmlSerializer();
  String xml = s.serialize(new String[] {"A", "B"});
  assertEquals("&lt;list&gt;&lt;el&gt;A&lt;/el&gt;&lt;el&gt;A&lt;/el&gt;&lt;/list&gt;", xml);
}</pre>
<p></code></p>
<p>this one is also wrong, for a different reason.  It&#8217;s syntactically valid, but does not contain the right information.</p>
<p>Even when I am not writing the client side, I would still write a client for my tests.  The client should do something with my data that is similar to what a typical real client would do.  At the very least, it should parse the XML to make sure it&#8217;s valid!  That would take care of the first broken test.  Then I would make the client extract the information from the serialized form, and make sure it contains the same information.</p>
<p><code></p>
<pre>
@Test public static void serializesArray() {
  String [] anArray = { "A", "B" };
  XmlSerializer s = new XmlSerializer();
  XmlClient c = new XmlClient();
  String xml = s.serialize(anArray);
  
  assertArrayEquals(anArray, c.parse(xml).toStringArray());
}</pre>
<p></code></p>

				
				<p class="postmetadata alt">
					<small>
						This entry was posted
												on 16 June 2010 at 08:37						and is filed under <a href="category/agile.html" rel="category tag">Agile</a>.
						You can follow any responses to this entry through the <a href="411/feed">RSS 2.0</a> feed.

													You can <a href="#respond">leave a response</a>, or <a href="411/trackback" rel="trackback">trackback</a> from your own site.

						
					</small>
				</p>

			</div>
		</div>

	
<!-- You can start editing here. -->

	<h3 id="comments">5 Responses to &#8220;Answering Jacopo&#8217;s comment&#8221;</h3> 

	<ol class="commentlist">

	
		<li class="alt" id="comment-93284">
			<cite><a href='http://jfranzoi.wordpress.com/' rel='external nofollow' class='url'>jacopo</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-93284" title="">June 16th, 2010 at 21:22</a> </small>

			<p>hi Matteo, thanks for the reply :)</p>
<p>from your previous post I thought your team mates were supposed to test-drive client code, to sent XML to webservice. so, examples I was thinking about were mainly related to that scenario: a (more or less) documented &#8220;contract&#8221; in terms of<br />
* message syntax<br />
* message data content</p>
<p>testing through a full serialization/deserialization loop would (probably) be too much, and not focused on task at hand: sent data to remote service.</p>
<p>asserting strict xml content would fail, as you noted, being fragile. but testing specific values, such as</p>
<p>assertContains(&#8220;A&#8221;, xml);</p>
<p>would probably be _good enough_. then, a final integration test, connecting to a remote service (or a fake local one, but through HTTP) would cast behaviour on stone, to be much more confidend.</p>
<p>what do you think?</p>

		</li>

	
	
		<li class="" id="comment-93285">
			<cite><a href='http://jfranzoi.wordpress.com/' rel='external nofollow' class='url'>jacopo</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-93285" title="">June 16th, 2010 at 21:25</a> </small>

			<p>well, snippet has been stripped ;) originally was:</p>
<p>assertContains(&#8220;&lt;el&gt;A&lt;el&gt;&quot;, xml);</p>

		</li>

	
	
		<li class="alt" id="comment-93288">
			<cite>matteo</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-93288" title="">June 17th, 2010 at 09:08</a> </small>

			<p>Hi Jacopo,</p>
<p>what other tests would help you develop and design your code incrementally, as opposed to simply checking that it works?</p>

		</li>

	
	
		<li class="" id="comment-93290">
			<cite><a href='http://jfranzoi.wordpress.com/' rel='external nofollow' class='url'>jacopo</a></cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-93290" title="">June 17th, 2010 at 20:38</a> </small>

			<p>hi Matteo,<br />
quoting your original post:</p>
<p>&#8220;This sort of tests supports incremental development. If my data structure was, for instance, a list, I could write a nice sequence of tests:<br />
* serializesAndRebuildsEmptyLists<br />
* serializesAndRebuildsSingletonLists<br />
* serializesAndRebuildsListsOfManyElements&#8221;</p>
<p>this still stands for syntax-checking tests (sticking with client code), where you&#8217;d probably assert, incrementally:</p>
<p>assertDoesNotContain(“&lt;el&amp;gt&quot;, s.serialize(emptyList));<br />
assertContainsTimes(1, “&lt;el&gt;A&lt;el&gt;&quot;, s.serialize(listWith(&quot;A&quot;)));<br />
assertContainsTimes(2, “&lt;el&gt;A&lt;el&gt;&quot;, s.serialize(listWith(&quot;A&quot;, &quot;A&quot;)));</p>
<p>or even better, with XPath:</p>
<p>assertCount(0, “//el&quot;, s.serialize(emptyList));<br />
assertCount(1, “//el[@text=&#039;A&#039;]&quot;, s.serialize(listWith(&quot;A&quot;)));<br />
assertCount(2, “//el[@text=&#039;A&#039;]&quot;, s.serialize(listWith(&quot;A&quot;, &quot;A&quot;)));</p>
<p>I was just stating that serialization/deserialization tests do not focus on intended goal for that piece of code: send XML data to a webservice.</p>
<p>when you say:</p>
<p>&quot;Note that this test is robust, as changes of the intermediate representation will not break it. [&#8230;] we could change it to byte array, or anything else, with no need to change this test&quot;</p>
<p>it was not clear to me why would you change such representation, given XML message forwarding was the original scope.</p>
<p>but you&#039;re probably right: I would probably use a subset of coarse-grained (integration) tests for driving development of such piece of code.</p>
<p>anyway, what feedback did you collected from last team you joined as a coach? did they find test-driving XML generation code useful?</p>

		</li>

	
	
		<li class="alt" id="comment-93291">
			<cite>matteo</cite> Says:
						<br />

			<small class="commentmetadata"><a href="#comment-93291" title="">June 17th, 2010 at 21:00</a> </small>

			<p>The XPath tests are in my opinion better than the ones with assertContains .  </p>
<p>The original goal for my team was to transmit a datastructure over the wire.  The format of the serialized data structure was not important, as long as it could be parsed reliably.  </p>
<p>What I mean to say is that even if your job is to develop the server side only, the value from your web service comes from being able to deserialize the data structure and do something with it.  This is why I may write a deserializer anyway.</p>
<p>The team I was working with was happy with testing against a literal string, though.  It will take a bit of time until they realize the limitations.  The tests they have, crude as they may be, are still good enough for them to drive development.</p>

		</li>

	
	
	</ol>

 


<h3 id="respond">Leave a Reply</h3>


<form action="http://matteo.vaccari.name/blog/wp-comments-post.php" method="post" id="commentform">


<p><input type="text" name="author" id="author" value="" size="22" tabindex="1" />
<label for="author"><small>Name (required)</small></label></p>

<p><input type="text" name="email" id="email" value="" size="22" tabindex="2" />
<label for="email"><small>Mail (will not be published) (required)</small></label></p>

<p><input type="text" name="url" id="url" value="" size="22" tabindex="3" />
<label for="url"><small>Website</small></label></p>


<!--<p><small><strong>XHTML:</strong> You can use these tags: &lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;s&gt; &lt;strike&gt; &lt;strong&gt; </small></p>-->

<p><textarea name="comment" id="comment" cols="100%" rows="10" tabindex="4"></textarea></p>

<p><input name="submit" type="submit" id="submit" tabindex="5" value="Submit Comment" />
<input type="hidden" name="comment_post_ID" value="411" />
</p>
<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="3ba2af79db" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="249"/></p>
</form>



	
    </div>

    <div id='right-col'>
        <div id="sidebar">
    <ul>

      <li>
        <form method="get" id="searchform" action="http://matteo.vaccari.name/blog/">
  <div>
    <input tabindex="1" type="text" value="" name="s" id="s" />
    <input type="submit" id="searchsubmit" value="Search" />
  </div>
</form>
      </li>

      <li>

        <h2>About</h2>

	I am a software developer working with <a href="http://thoughtworks.com/">Thoughtworks Italia</a>.
        I'm a fan of <a
        href="http://extremeprogramming.org/">Extreme Programming</a>.
        I&nbsp;helped organize the <a
        href="http://essap.dicom.uninsubria.it/">European Summer School on
        Agile Programming</a>

      </li>

      <li>
            </li>

      <li class="pagenav"><h2>Pages</h2><ul><li class="page_item page-item-851"><a href="../selected-tdd-resources-to-start.html">Selected TDD Resources To Start</a></li>
<li class="page_item page-item-583"><a href="../tdd-resources.html">TDD Resources</a></li>
<li class="page_item page-item-247"><a href="../the-hexagonal-architecture.html">The Hexagonal Architecture</a></li>
</ul></li>

      
      <li><h2>Archives</h2>
        <ul>
        	<li><a href='date/2018/10.html'>October 2018</a></li>
	<li><a href='date/2017/09.html'>September 2017</a></li>
	<li><a href='date/2016/08.html'>August 2016</a></li>
	<li><a href='date/2016/03.html'>March 2016</a></li>
	<li><a href='date/2016/01.html'>January 2016</a></li>
	<li><a href='date/2014/12.html'>December 2014</a></li>
	<li><a href='date/2014/10.html'>October 2014</a></li>
	<li><a href='date/2014/06.html'>June 2014</a></li>
	<li><a href='date/2014/02.html'>February 2014</a></li>
	<li><a href='date/2013/12.html'>December 2013</a></li>
	<li><a href='date/2013/11.html'>November 2013</a></li>
	<li><a href='date/2013/06.html'>June 2013</a></li>
	<li><a href='date/2013/05.html'>May 2013</a></li>
	<li><a href='date/2013/03.html'>March 2013</a></li>
	<li><a href='date/2013/02.html'>February 2013</a></li>
	<li><a href='date/2012/10.html'>October 2012</a></li>
	<li><a href='date/2012/08.html'>August 2012</a></li>
	<li><a href='date/2012/07.html'>July 2012</a></li>
	<li><a href='date/2012/06.html'>June 2012</a></li>
	<li><a href='date/2012/05.html'>May 2012</a></li>
	<li><a href='date/2012/04.html'>April 2012</a></li>
	<li><a href='date/2012/01.html'>January 2012</a></li>
	<li><a href='date/2011/12.html'>December 2011</a></li>
	<li><a href='date/2011/11.html'>November 2011</a></li>
	<li><a href='date/2011/10.html'>October 2011</a></li>
	<li><a href='date/2011/07.html'>July 2011</a></li>
	<li><a href='date/2011/06.html'>June 2011</a></li>
	<li><a href='date/2011/05.html'>May 2011</a></li>
	<li><a href='date/2011/04.html'>April 2011</a></li>
	<li><a href='date/2011/03.html'>March 2011</a></li>
	<li><a href='date/2011/02.html'>February 2011</a></li>
	<li><a href='date/2010/11.html'>November 2010</a></li>
	<li><a href='date/2010/10.html'>October 2010</a></li>
	<li><a href='date/2010/09.html'>September 2010</a></li>
	<li><a href='date/2010/08.html'>August 2010</a></li>
	<li><a href='date/2010/07.html'>July 2010</a></li>
	<li><a href='date/2010/06.html'>June 2010</a></li>
	<li><a href='date/2010/05.html'>May 2010</a></li>
	<li><a href='date/2010/04.html'>April 2010</a></li>
	<li><a href='date/2010/03.html'>March 2010</a></li>
	<li><a href='date/2010/02.html'>February 2010</a></li>
	<li><a href='date/2010/01.html'>January 2010</a></li>
	<li><a href='date/2009/12.html'>December 2009</a></li>
	<li><a href='date/2009/11.html'>November 2009</a></li>
	<li><a href='date/2009/10.html'>October 2009</a></li>
	<li><a href='date/2009/09.html'>September 2009</a></li>
	<li><a href='date/2009/07.html'>July 2009</a></li>
	<li><a href='date/2009/05.html'>May 2009</a></li>
	<li><a href='date/2009/04.html'>April 2009</a></li>
	<li><a href='date/2009/03.html'>March 2009</a></li>
	<li><a href='date/2009/02.html'>February 2009</a></li>
	<li><a href='date/2009/01.html'>January 2009</a></li>
	<li><a href='date/2008/12.html'>December 2008</a></li>
	<li><a href='date/2008/11.html'>November 2008</a></li>
	<li><a href='date/2008/10.html'>October 2008</a></li>
	<li><a href='date/2008/09.html'>September 2008</a></li>
	<li><a href='date/2008/07.html'>July 2008</a></li>
	<li><a href='date/2008/06.html'>June 2008</a></li>
	<li><a href='date/2008/05.html'>May 2008</a></li>
	<li><a href='date/2008/04.html'>April 2008</a></li>
	<li><a href='date/2008/01.html'>January 2008</a></li>
	<li><a href='date/2007/11.html'>November 2007</a></li>
	<li><a href='date/2007/10.html'>October 2007</a></li>
	<li><a href='date/2007/09.html'>September 2007</a></li>
	<li><a href='date/2007/06.html'>June 2007</a></li>
	<li><a href='date/2007/05.html'>May 2007</a></li>
	<li><a href='date/2007/04.html'>April 2007</a></li>
	<li><a href='date/2007/03.html'>March 2007</a></li>
	<li><a href='date/2007/02.html'>February 2007</a></li>
	<li><a href='date/2007/01.html'>January 2007</a></li>
	<li><a href='date/2006/12.html'>December 2006</a></li>
	<li><a href='date/2006/11.html'>November 2006</a></li>
	<li><a href='date/2006/10.html'>October 2006</a></li>
	<li><a href='date/2006/09.html'>September 2006</a></li>
	<li><a href='date/2006/08.html'>August 2006</a></li>
	<li><a href='date/2006/07.html'>July 2006</a></li>
	<li><a href='date/2006/06.html'>June 2006</a></li>
	<li><a href='date/2006/05.html'>May 2006</a></li>
	<li><a href='date/2006/04.html'>April 2006</a></li>
	<li><a href='date/2006/03.html'>March 2006</a></li>
	<li><a href='date/2006/02.html'>February 2006</a></li>
	<li><a href='date/2006/01.html'>January 2006</a></li>
        </ul>
      </li>

      <li><h2>Categories</h2>
        <ul>
        	<li class="cat-item cat-item-1"><a href="category/agile.html" >Agile</a> (229)
</li>
	<li class="cat-item cat-item-3"><a href="category/books.html" >Books</a> (2)
</li>
	<li class="cat-item cat-item-11"><a href="category/design-exercise.html" >Design Exercise</a> (5)
</li>
	<li class="cat-item cat-item-6"><a href="category/essay.html" >Essay</a> (13)
</li>
	<li class="cat-item cat-item-8"><a href="category/expressive-code.html" >Expressive Code</a> (11)
</li>
	<li class="cat-item cat-item-10"><a href="category/fundamentals.html" >Fundamentals</a> (6)
</li>
	<li class="cat-item cat-item-9"><a href="category/other.html" >other</a> (1)
</li>
        </ul>
      </li>

      
    </ul>
  </div>

    </div>
</div>


<hr />
<div id="footer">
<address>
  <script type="text/javascript">eval(unescape('%64%6f%63%75%6d%65%6e%74%2e%77%72%69%74%65%28%27%3c%61%20%68%72%65%66%3d%22%6d%61%69%6c%74%6f%3a%76%61%63%63%61%72%69%40%70%6f%62%6f%78%2e%63%6f%6d%22%3e%76%61%63%63%61%72%69%40%70%6f%62%6f%78%2e%63%6f%6d%3c%2f%61%3e%27%29%3b'))</script>
</address>
</div>
</div>
  <script type='text/javascript' src='../wp-includes/js/wp-embed.min3c21.js?ver=5.1.1'></script>
<script async="async" type='text/javascript' src='../wp-content/plugins/akismet/_inc/form0235.js?ver=4.1.1'></script>
</body>

<!-- Mirrored from matteo.vaccari.name/blog/archives/411 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 24 Sep 2021 10:26:42 GMT -->
</html>
